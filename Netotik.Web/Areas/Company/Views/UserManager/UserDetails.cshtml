@model Netotik.ViewModels.Mikrotik.UsermanagerUser
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    //var list = ViewBag.logins as List<LoginHistory>;
}
<div class="ibox-content m-b-sm border-bottom">
    <div class="row">
        <div class="col-md-12">
            <a class="btn btn-default btn-outline pull-left" href="@Url.Action(MVC.Company.UserManager.ActionNames.UserList, MVC.Company.UserManager.Name)">
                <span class="fa fa-reply"></span>
                @Netotik.Resources.Captions.Back
            </a>
        </div>
    </div>
</div>

<div class="row">
    <div class="tabs-container">
        <ul class="nav nav-tabs">
            <li class="active">
                <a data-toggle="tab" href="#profile"><i class="icon-2x icon-user"></i> اطلاعات پروفایل</a>
            </li>
            <li class="">
                <a data-toggle="tab" href="#connections"><i class="icon-2x icon-flag"></i> اتصالات </a>
            </li>
            <li class="">
                <a data-toggle="tab" href="#transfer"><i class="icon-2x icon-flag"></i> حجم </a>
            </li>
            <li class="">
                <a data-toggle="tab" href="#time"><i class="icon-2x icon-flag"></i> زمان </a>
            </li>
        </ul>
        <div class="tab-content">
            <div id="profile" class="tab-pane active form-horizontal">
                <div class="panel-body">
                    <fieldset>
                        <div class="form-group">
                            <div class="col-md-5">
                                @Html.DisplayFor(model => model.first_name)
                            </div>
                            <div class="col-md-5">
                                @Html.DisplayFor(model => model.last_name)
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <div class="col-md-5">
                                @Html.DisplayFor(model => model.location)
                            </div>
                            <div class="col-md-5">
                                @Html.DisplayFor(model => model.comment)
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <div class="col-md-5">
                                @Html.DisplayFor(model => model.email)
                            </div>
                            <div class="col-md-5">
                                @Html.DisplayFor(model => model.phone)
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <div class="col-md-5">
                                @Html.DisplayFor(model => model.shared_users)
                            </div>
                            <div class="col-md-5">
                                @Html.DisplayFor(model => model.ip_address)
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <div class="col-md-5">
                                @Html.DisplayFor(model => model.username)
                            </div>
                            <div class="col-md-5">
                                @Html.DisplayFor(model => model.password)
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <div class="col-md-5">
                                @Html.DisplayFor(model => model.actual_profile)
                            </div>
                            <div class="col-md-5">
                                @Html.DisplayFor(model => model.disabled)
                            </div>
                        </div>
                    </fieldset>
                </div>
            </div>
            <div id="connections" class="tab-pane form-horizontal">
                <div class="panel-body">
                    <input type="text" class="form-control input-sm m-b-xs" id="filter"
                           placeholder="جستجوی زمان،حجم،پورت،IP و...">

                    <table class="footable table table-stripped toggle-arrow-tiny" data-page-size="30" data-filter=#filter>
                        <thead>
                            <tr>
                                <th data-toggle="true">نام کاربری</th>
                                <th>زمان اتصال از</th>
                                <th>تا</th>
                                <th>مدت زمان اتصال</th>
                                <th>دانلود(MB)</th>
                                <th>آپلود(MB)</th>
                                <th data-hide="all">Nas Port</th>
                                <th data-hide="all">Nas Port Type</th>
                                <th data-hide="all">Nas Port ID</th>
                                <th data-hide="all">Calling Station ID</th>
                                <th data-hide="all">Acct Session ID</th>
                                <th data-hide="all">User IP</th>
                                <th data-hide="all">Host IP</th>
                                <th data-hide="all">Status</th>
                                <th data-hide="all">Terminate Cause</th>
                            @{ViewBag.datetemp = 0; }</tr>
                        </thead>
                        <tbody>
                            
                            @foreach (var item in ViewBag.session)
                            {
                                if (ViewBag.datetemp == 0) {
                                    ViewBag.datetemp = item.from_time;
                                        }
                                <tr>
                                    <td>@item.user</td>
                                    <td>@item.from_time</td>
                                    <td>@item.till_time</td>
                                    <td>@item.uptime.Replace("s", "ثانیه").Replace("h", "ساعت").Replace("m", "دقیقه").Replace("d", "روز")</td>
                                    <td>@(Int32.Parse(item.download) / 1048576)</td>
                                    <td>@(Int32.Parse(item.upload) / 1048576)</td>
                                    <td>@item.nas_port</td>
                                    <td>@item.nas_port_type</td>
                                    <td>@item.nas_port_id</td>
                                    <td>@item.calling_station_id</td>
                                    <td>@item.acct_session_id</td>
                                    <td>@item.user_ip</td>
                                    <td>@item.host_ip</td>
                                    <td>@item.status</td>
                                    <td>@item.terminate_cause</td>
                                </tr>
                            }
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="5">
                                    <ul class="pagination pull-right"></ul>
                                </td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
            <div id="transfer" class="tab-pane form-horizontal">
                <div class="panel-body">
                    <div class="form-group">
                        <div class="col-md-5">
                            @Html.DisplayFor(model => model.download_used)
                        </div>
                        <div class="col-md-5">
                            @Html.DisplayFor(model => model.upload_used)
                        </div>
                    </div>
                    <div class="hr-line-dashed"></div>
                </div>
                </div>
            <div id="time" class="tab-pane form-horizontal">
                <div class="panel-body">
                    <div class="form-group">
                        <div class="col-md-5">
                            @Html.DisplayFor(model => model.uptime_used)
                        </div>
                        <div class="col-md-5">
                            @Html.DisplayFor(model => model.last_seen)
                        </div>
                    </div>
                </div>
                </div>
        </div>

    </div>
</div>
@section ScriptUp {
    <link href="~/Content/css/plugins/footable/footable.core.css" rel="stylesheet">
}
@section DownScript {
    <script src="~/Content/js/plugins/footable/footable.all.min.js"></script>
    <script>
        $(document).ready(function () {
            $('.footable').footable();
        });
    </script>
}
